{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["const url = process.env.REACT_APP_URL_LINK\n\nexport const handleOpen = (message, accountId) => {\n  console.log(message)\n  if (!Object.keys(EVENT_MESSAGES).includes(message)) {\n    message = 'linkConnect'\n  }\n  window.parent.postMessage({ type: EVENT_MESSAGES[message], accountId }, '*')\n}\n\nexport const handleClose = (url) => {\n  window.parent.postMessage({ type: EVENT_MESSAGES.close, url }, '*')\n}\n\nconst EVENT_MESSAGES = {\n  linkConnect: `${url}`,\n  close: 'blockmate-iframe-close',\n  verifyPhone: `${url}verify-phone`,\n  changePhone: `${url}change-phone`,\n  enableTransfer: `${url}enable-transfer`,\n  transferAssets: `${url}transfer-assets`,\n  cryptoSavings: `${url}crypto-savings`\n}\n\nexport const LinkModal = ({ jwt, url, cleanupActions = {} }) => {\n  if (!jwt) return null\n\n  const body = document.querySelector('body')\n\n  const iframeStyle =\n    'display:block; position:fixed; width:100%; height:100%; z-index:100; border:none; top:0; right:0'\n\n  const createIframe = (url, accountId) => {\n    const iframeId = 'link-iframe'\n    const existingIframe = document.getElementById(iframeId)\n    if (!existingIframe) {\n      const iframe = document.createElement('iframe')\n      iframe.setAttribute('src', `${url}/?jwt=${jwt}&accountId=${accountId}`)\n      iframe.setAttribute('style', iframeStyle)\n      iframe.setAttribute('id', iframeId)\n      body.appendChild(iframe)\n    }\n  }\n\n  const removeIframe = (event) => {\n    const iframe = document.querySelector('#link-iframe')\n    body.removeChild(iframe)\n    if (event.data.url) {\n      window.location = event.data.url\n    }\n    const endResult = event?.data?.endResult\n    if (endResult && cleanupActions[endResult]) {\n      cleanupActions[endResult]()\n    }\n  }\n\n  window.onmessage = function (event) {\n    if (!Object.values(EVENT_MESSAGES).includes(event.data.type)) {\n      return null\n    }\n    if (event?.data?.type === EVENT_MESSAGES.close) {\n      removeIframe(event)\n    } else {\n      createIframe(event.data.type, event.data.accountId)\n    }\n  }\n\n  return null\n}\n"],"names":["url","process","env","REACT_APP_URL_LINK","handleOpen","message","accountId","console","log","Object","keys","EVENT_MESSAGES","includes","window","parent","postMessage","type","handleClose","close","linkConnect","verifyPhone","changePhone","enableTransfer","transferAssets","cryptoSavings","LinkModal","jwt","cleanupActions","body","document","querySelector","iframeStyle","createIframe","iframeId","existingIframe","getElementById","iframe","createElement","setAttribute","appendChild","removeIframe","event","removeChild","data","location","endResult","onmessage","values"],"mappings":"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"}