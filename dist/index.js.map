{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["const url2 = 'https://onet.pl'\n\nexport const handleOpen = (message = '', accountId) => {\n  console.log(message)\n  if (!Object.keys(EVENT_MESSAGES).includes(message)) {\n    message = 'linkConnect'\n  }\n  window.parent.postMessage({ type: EVENT_MESSAGES[message], accountId }, '*')\n}\n\nexport const handleClose = (url) => {\n  window.parent.postMessage({ type: EVENT_MESSAGES.close, url }, '*')\n}\n\nconst EVENT_MESSAGES = {\n  linkConnect: `${url2}`,\n  close: 'blockmate-iframe-close',\n  verifyPhone: `${url2}verify-phone`,\n  changePhone: `${url2}change-phone`,\n  enableTransfer: `${url2}enable-transfer`,\n  transferAssets: `${url2}transfer-assets`,\n  cryptoSavings: `${url2}crypto-savings`\n}\n\nexport const LinkModal = ({ jwt, url, cleanupActions = {} }) => {\n  console.log('link modal init')\n  if (!jwt) return null\n\n  const body = document.querySelector('body')\n\n  const iframeStyle =\n    'display:block; position:fixed; width:100%; height:100%; z-index:100; border:none; top:0; right:0'\n\n  const createIframe = (url, accountId) => {\n    console.log('create iframe')\n    const iframeId = 'link-iframe'\n    const existingIframe = document.getElementById(iframeId)\n    if (!existingIframe) {\n      const iframe = document.createElement('iframe')\n      iframe.setAttribute('src', `${url}/?jwt=${jwt}&accountId=${accountId}`)\n      iframe.setAttribute('style', iframeStyle)\n      iframe.setAttribute('id', iframeId)\n      body.appendChild(iframe)\n    }\n  }\n\n  const removeIframe = (event) => {\n    const iframe = document.querySelector('#link-iframe')\n    body.removeChild(iframe)\n    if (event.data.url) {\n      window.location = event.data.url\n    }\n    const endResult = event?.data?.endResult\n    if (endResult && cleanupActions[endResult]) {\n      cleanupActions[endResult]()\n    }\n  }\n\n  window.onmessage = function (event) {\n    console.log('onmessage', event)\n    if (!Object.values(EVENT_MESSAGES).includes(event.data.type)) {\n      console.log('on message null')\n      return null\n    }\n    if (event?.data?.type === EVENT_MESSAGES.close) {\n      removeIframe(event)\n    } else {\n      console.log('else create iframe')\n      createIframe(event.data.type, event.data.accountId)\n    }\n  }\n\n  return null\n}\n"],"names":["url2","handleOpen","message","accountId","console","log","Object","keys","EVENT_MESSAGES","includes","window","parent","postMessage","type","handleClose","url","close","linkConnect","verifyPhone","changePhone","enableTransfer","transferAssets","cryptoSavings","LinkModal","jwt","cleanupActions","body","document","querySelector","iframeStyle","createIframe","iframeId","existingIframe","getElementById","iframe","createElement","setAttribute","appendChild","removeIframe","event","removeChild","data","location","endResult","onmessage","values"],"mappings":"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"}