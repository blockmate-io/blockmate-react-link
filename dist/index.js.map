{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["export const handleOpen = (message, accountId) => {\n  if (!Object.keys(EVENT_MESSAGES).includes(message)) {\n    message = 'linkConnect'\n  }\n  window.parent.postMessage({ type: EVENT_MESSAGES[message], accountId }, '*')\n}\n\nexport const handleClose = (url) => {\n  window.parent.postMessage({ type: EVENT_MESSAGES.close, url }, '*')\n}\n\nconst EVENT_MESSAGES = {\n  linkConnect: 'http://localhost:3000',\n  close: 'blockmate-iframe-close',\n  verifyPhone: 'http://localhost:3000/verify-phone',\n  changePhone: 'http://localhost:3000/change-phone',\n  enableTransfer: 'http://localhost:3000/enable-transfer',\n  transferAssets: 'http://localhost:3000/transfer-assets',\n  cryptoSavings: 'http://localhost:3000/crypto-savings'\n}\n\nexport const LinkModal = ({ jwt, url }) => {\n  if (!jwt) return null\n\n  const body = document.querySelector('body')\n\n  const iframeStyle =\n    'display:block; position:fixed; width:100%; height:100%; z-index:100; border:none; top:0; right:0'\n\n  const createIframe = (url, accountId) => {\n    const iframe = document.createElement('iframe')\n    iframe.setAttribute('src', `${url}/?jwt=${jwt}&accountId=${accountId}`)\n    iframe.setAttribute('style', iframeStyle)\n    iframe.setAttribute('id', 'link-iframe')\n    body.appendChild(iframe)\n  }\n\n  const removeIframe = (event) => {\n    const iframe = document.querySelector('#link-iframe')\n    body.removeChild(iframe)\n    if (event.data.url) {\n      window.location = event.data.url\n    }\n  }\n\n  window.onmessage = function (event) {\n    if (!Object.values(EVENT_MESSAGES).includes(event.data.type)) {\n      return null\n    }\n    if (event?.data?.type === EVENT_MESSAGES.close) {\n      removeIframe(event)\n    } else {\n      createIframe(event.data.type, event.data.accountId)\n    }\n  }\n\n  return null\n}\n"],"names":["handleOpen","message","accountId","Object","keys","EVENT_MESSAGES","includes","window","parent","postMessage","type","handleClose","url","close","linkConnect","verifyPhone","changePhone","enableTransfer","transferAssets","cryptoSavings","LinkModal","jwt","body","document","querySelector","iframeStyle","createIframe","iframe","createElement","setAttribute","appendChild","removeIframe","event","removeChild","data","location","onmessage","values"],"mappings":"IAAaA,UAAU,GAAG,SAAbA,UAAU,CAAIC,OAAO,EAAEC,SAAS,EAAK;EAChD,IAAI,CAACC,MAAM,CAACC,IAAI,CAACC,cAAc,CAAC,CAACC,QAAQ,CAACL,OAAO,CAAC,EAAE;IAClDA,OAAO,GAAG,aAAa;;EAEzBM,MAAM,CAACC,MAAM,CAACC,WAAW,CAAC;IAAEC,IAAI,EAAEL,cAAc,CAACJ,OAAO,CAAC;IAAEC,SAAS,EAATA;GAAW,EAAE,GAAG,CAAC;AAC9E;IAEaS,WAAW,GAAG,SAAdA,WAAW,CAAIC,GAAG,EAAK;EAClCL,MAAM,CAACC,MAAM,CAACC,WAAW,CAAC;IAAEC,IAAI,EAAEL,cAAc,CAACQ,KAAK;IAAED,GAAG,EAAHA;GAAK,EAAE,GAAG,CAAC;AACrE;AAEA,IAAMP,cAAc,GAAG;EACrBS,WAAW,EAAE,uBAAuB;EACpCD,KAAK,EAAE,wBAAwB;EAC/BE,WAAW,EAAE,oCAAoC;EACjDC,WAAW,EAAE,oCAAoC;EACjDC,cAAc,EAAE,uCAAuC;EACvDC,cAAc,EAAE,uCAAuC;EACvDC,aAAa,EAAE;AACjB,CAAC;IAEYC,SAAS,GAAG,SAAZA,SAAS,OAAqB;MAAfC,GAAG,QAAHA,GAAG;EAC7B,IAAI,CAACA,GAAG,EAAE,OAAO,IAAI;EAErB,IAAMC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;EAE3C,IAAMC,WAAW,GACf,kGAAkG;EAEpG,IAAMC,YAAY,GAAG,SAAfA,YAAY,CAAId,GAAG,EAAEV,SAAS,EAAK;IACvC,IAAMyB,MAAM,GAAGJ,QAAQ,CAACK,aAAa,CAAC,QAAQ,CAAC;IAC/CD,MAAM,CAACE,YAAY,CAAC,KAAK,EAAKjB,GAAG,cAASS,GAAG,mBAAcnB,SAAS,CAAG;IACvEyB,MAAM,CAACE,YAAY,CAAC,OAAO,EAAEJ,WAAW,CAAC;IACzCE,MAAM,CAACE,YAAY,CAAC,IAAI,EAAE,aAAa,CAAC;IACxCP,IAAI,CAACQ,WAAW,CAACH,MAAM,CAAC;GACzB;EAED,IAAMI,YAAY,GAAG,SAAfA,YAAY,CAAIC,KAAK,EAAK;IAC9B,IAAML,MAAM,GAAGJ,QAAQ,CAACC,aAAa,CAAC,cAAc,CAAC;IACrDF,IAAI,CAACW,WAAW,CAACN,MAAM,CAAC;IACxB,IAAIK,KAAK,CAACE,IAAI,CAACtB,GAAG,EAAE;MAClBL,MAAM,CAAC4B,QAAQ,GAAGH,KAAK,CAACE,IAAI,CAACtB,GAAG;;GAEnC;EAEDL,MAAM,CAAC6B,SAAS,GAAG,UAAUJ,KAAK,EAAE;IAAA;IAClC,IAAI,CAAC7B,MAAM,CAACkC,MAAM,CAAChC,cAAc,CAAC,CAACC,QAAQ,CAAC0B,KAAK,CAACE,IAAI,CAACxB,IAAI,CAAC,EAAE;MAC5D,OAAO,IAAI;;IAEb,IAAI,CAAAsB,KAAK,aAALA,KAAK,sCAALA,KAAK,CAAEE,IAAI,gDAAX,YAAaxB,IAAI,MAAKL,cAAc,CAACQ,KAAK,EAAE;MAC9CkB,YAAY,CAACC,KAAK,CAAC;KACpB,MAAM;MACLN,YAAY,CAACM,KAAK,CAACE,IAAI,CAACxB,IAAI,EAAEsB,KAAK,CAACE,IAAI,CAAChC,SAAS,CAAC;;GAEtD;EAED,OAAO,IAAI;AACb;;;;;;"}