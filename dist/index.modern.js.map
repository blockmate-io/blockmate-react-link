{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["export const handleOpen = () => {\n  window.parent.postMessage({ type: EVENT_MESSAGES.open }, '*')\n}\n\nexport const handleClose = (url) => {\n  window.parent.postMessage({ type: EVENT_MESSAGES.close, url }, '*')\n}\n\nconst EVENT_MESSAGES = {\n  open: 'blockmate-iframe-open',\n  close: 'blockmate-iframe-close'\n}\n\nexport const LinkModal = ({ jwt, url = 'https://link-dev.blockmate.io', cleanupActions = {} }) => {\n  if (!jwt) return null\n\n  const body = document.querySelector('body')\n\n  const iframeStyle =\n    'display:block; position:fixed; width:100%; height:100%; z-index:100; border:none; top:0; right:0'\n\n  const createIframe = () => {\n    const iframeId = 'link-iframe';\n    const existingIframe = document.getElementById(iframeId);\n    if (!existingIframe) {\n      const iframe = document.createElement('iframe');\n      iframe.setAttribute('src', `${url}/?jwt=${jwt}`)\n      iframe.setAttribute('style', iframeStyle)\n      iframe.setAttribute('id', iframeId)\n      body.appendChild(iframe)\n    }\n  }\n\n  const removeIframe = (event) => {\n    const iframe = document.querySelector('#link-iframe')\n    body.removeChild(iframe)\n    if (event.data.url) {\n      window.location = event.data.url\n    }\n    const endResult = event?.data?.endResult;\n    if (endResult && cleanupActions[endResult]) {\n      cleanupActions[endResult]();\n    }\n  }\n\n  window.onmessage = function (event) {\n    if (event?.data?.type === EVENT_MESSAGES.close) {\n      removeIframe(event)\n    }\n    if (event?.data?.type === EVENT_MESSAGES.open) {\n      createIframe()\n    }\n  }\n\n  return null\n}\n"],"names":["handleOpen","window","parent","postMessage","type","EVENT_MESSAGES","open","handleClose","url","close","LinkModal","_ref","jwt","_ref$url","_ref$cleanupActions","cleanupActions","body","document","querySelector","iframeStyle","createIframe","iframeId","existingIframe","getElementById","iframe","createElement","setAttribute","appendChild","removeIframe","event","_event$data","removeChild","data","location","endResult","onmessage","_event$data2","_event$data3"],"mappings":"IAAaA,UAAU,GAAG,SAAbA,UAAUA,GAAS;EAC9BC,MAAM,CAACC,MAAM,CAACC,WAAW,CAAC;IAAEC,IAAI,EAAEC,cAAc,CAACC;GAAM,EAAE,GAAG,CAAC;AAC/D;IAEaC,WAAW,GAAG,SAAdA,WAAWA,CAAIC,GAAG,EAAK;EAClCP,MAAM,CAACC,MAAM,CAACC,WAAW,CAAC;IAAEC,IAAI,EAAEC,cAAc,CAACI,KAAK;IAAED,GAAG,EAAHA;GAAK,EAAE,GAAG,CAAC;AACrE;AAEA,IAAMH,cAAc,GAAG;EACrBC,IAAI,EAAE,uBAAuB;EAC7BG,KAAK,EAAE;AACT,CAAC;IAEYC,SAAS,GAAG,SAAZA,SAASA,CAAAC,IAAA,EAA4E;EAAA,IAAtEC,GAAG,GAAAD,IAAA,CAAHC,GAAG;IAAAC,QAAA,GAAAF,IAAA,CAAEH,GAAG;IAAHA,GAAG,GAAAK,QAAA,cAAG,+BAA+B,GAAAA,QAAA;IAAAC,mBAAA,GAAAH,IAAA,CAAEI,cAAc;IAAdA,cAAc,GAAAD,mBAAA,cAAG,EAAE,GAAAA,mBAAA;EACzF,IAAI,CAACF,GAAG,EAAE,OAAO,IAAI;EAErB,IAAMI,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;EAE3C,IAAMC,WAAW,GACf,kGAAkG;EAEpG,IAAMC,YAAY,GAAG,SAAfA,YAAYA,GAAS;IACzB,IAAMC,QAAQ,GAAG,aAAa;IAC9B,IAAMC,cAAc,GAAGL,QAAQ,CAACM,cAAc,CAACF,QAAQ,CAAC;IACxD,IAAI,CAACC,cAAc,EAAE;MACnB,IAAME,MAAM,GAAGP,QAAQ,CAACQ,aAAa,CAAC,QAAQ,CAAC;MAC/CD,MAAM,CAACE,YAAY,CAAC,KAAK,EAAKlB,GAAG,cAASI,GAAK,CAAC;MAChDY,MAAM,CAACE,YAAY,CAAC,OAAO,EAAEP,WAAW,CAAC;MACzCK,MAAM,CAACE,YAAY,CAAC,IAAI,EAAEL,QAAQ,CAAC;MACnCL,IAAI,CAACW,WAAW,CAACH,MAAM,CAAC;;GAE3B;EAED,IAAMI,YAAY,GAAG,SAAfA,YAAYA,CAAIC,KAAK,EAAK;IAAA,IAAAC,WAAA;IAC9B,IAAMN,MAAM,GAAGP,QAAQ,CAACC,aAAa,CAAC,cAAc,CAAC;IACrDF,IAAI,CAACe,WAAW,CAACP,MAAM,CAAC;IACxB,IAAIK,KAAK,CAACG,IAAI,CAACxB,GAAG,EAAE;MAClBP,MAAM,CAACgC,QAAQ,GAAGJ,KAAK,CAACG,IAAI,CAACxB,GAAG;;IAElC,IAAM0B,SAAS,GAAGL,KAAK,aAALA,KAAK,wBAAAC,WAAA,GAALD,KAAK,CAAEG,IAAI,cAAAF,WAAA,uBAAXA,WAAA,CAAaI,SAAS;IACxC,IAAIA,SAAS,IAAInB,cAAc,CAACmB,SAAS,CAAC,EAAE;MAC1CnB,cAAc,CAACmB,SAAS,CAAC,EAAE;;GAE9B;EAEDjC,MAAM,CAACkC,SAAS,GAAG,UAAUN,KAAK,EAAE;IAAA,IAAAO,YAAA,EAAAC,YAAA;IAClC,IAAI,CAAAR,KAAK,aAALA,KAAK,wBAAAO,YAAA,GAALP,KAAK,CAAEG,IAAI,cAAAI,YAAA,uBAAXA,YAAA,CAAahC,IAAI,MAAKC,cAAc,CAACI,KAAK,EAAE;MAC9CmB,YAAY,CAACC,KAAK,CAAC;;IAErB,IAAI,CAAAA,KAAK,aAALA,KAAK,wBAAAQ,YAAA,GAALR,KAAK,CAAEG,IAAI,cAAAK,YAAA,uBAAXA,YAAA,CAAajC,IAAI,MAAKC,cAAc,CAACC,IAAI,EAAE;MAC7Cc,YAAY,EAAE;;GAEjB;EAED,OAAO,IAAI;AACb;;;;"}