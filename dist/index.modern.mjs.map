{"version":3,"file":"index.modern.mjs","sources":["../src/index.js"],"sourcesContent":["/* eslint-disable */\n\nwindow.Buffer = window.Buffer || require('buffer').Buffer\n\nconst EVENT_MESSAGES = {\n  linkConnect: ``,\n  verifyPhone: `verify-phone`,\n  changePhone: `change-phone`,\n  enableTransfer: `enable-transfer`,\n  transferAssets: `transfer-assets`,\n  cryptoSavings: `crypto-savings`,\n  withdrawAssets: `withdraw-assets`,\n  close: 'blockmate-iframe-close',\n  redirect: 'redirect',\n  redirectClose: 'redirect-close',\n  deposit: 'deposit-exchange',\n  directDeposit: 'deposit-wallet-connect',\n  withdrawal: 'withdrawal-exchange',\n}\n\nconst TRUSTED_ORIGINS = [\n  'https://link.blockmate.io',\n  'https://link-dev-ovh.blockmate.io',\n  'https://link-cs.blockmate.io',\n  'http://localhost:3000'\n]\n\nconst OAUTH_QUERY_PARAM = 'oauthConnectedAccount'\nconst OAUTH_LOCAL_STORAGE_KEY = 'oauth_connected_account'\nconst DEPOSIT_OAUTH_SUCCESS_STEP = 'oauth_success'\nconst DEPOSIT_ID_PARAM = 'deposit_id'\nconst DEPOSIT_SUCCESS_PARAM = 'success'\nconst DEPOSIT_SUCCESS_PARAM_FOR_MERCHANT = 'payment_success'\nconst DEPOSIT_ERROR_STORAGE_KEY = 'deposit_error'\nconst DEPOSIT_JWT_LOCAL_STORAGE_KEY = 'deposit_jwt'\nconst DEPOSIT_LANG_LOCAL_STORAGE_KEY = 'deposit_lang'\nconst MODAL_TYPE_LOCAL_STORAGE_KEY = 'modal_type'\n\nexport const handleOpen = (\n  message = '',\n  accountId,\n  oauthConnectedAccount,\n  extraUrlParams\n) => {\n  console.log('[BlockmateLink] handleOpen called', {\n    message,\n    accountId,\n    oauthConnectedAccount,\n    extraUrlParams\n  })\n  if (!Object.keys(EVENT_MESSAGES).includes(message)) {\n    message = 'linkConnect'\n  }\n  if (extraUrlParams?.jwt) {\n    localStorage.setItem(DEPOSIT_JWT_LOCAL_STORAGE_KEY, extraUrlParams.jwt)\n  }\n  if (extraUrlParams?.lang) {\n    localStorage.setItem(DEPOSIT_LANG_LOCAL_STORAGE_KEY, extraUrlParams.lang)\n  }\n  const storedLang = localStorage.getItem(DEPOSIT_LANG_LOCAL_STORAGE_KEY)\n  const mergedExtraUrlParams = {\n    ...(extraUrlParams ?? {})\n  }\n  if (!Object.hasOwn(mergedExtraUrlParams, 'lang') && storedLang) {\n    mergedExtraUrlParams.lang = storedLang\n  }\n  console.log('[BlockmateLink] handleOpen merged params', {\n    message,\n    mergedExtraUrlParams\n  })\n  localStorage.setItem(MODAL_TYPE_LOCAL_STORAGE_KEY, message)\n  window.parent.postMessage(\n    {\n      type: message,\n      accountId,\n      oauthConnectedAccount,\n      extraUrlParams: mergedExtraUrlParams\n    },\n    '*'\n  )\n}\n\nexport const handleClose = (endResult) => {\n  window.parent.postMessage({ type: 'close', endResult }, '*')\n}\n\nexport const handleRedirect = (targetUrl, inNewTab = false) => {\n  window.parent.postMessage({ type: 'redirect', targetUrl, inNewTab }, '*')\n}\n\nexport const handleCloseRedirect = () => {\n  console.log('[BlockmateLink] handleCloseRedirect called')\n  window.parent.postMessage({ type: 'redirectClose' }, '*')\n}\n\nexport const handleInit = () => {\n  window.parent.postMessage({ type: 'init' }, '*')\n}\n\nexport const createLinkModal = ({\n  jwt,\n  url = 'https://link.blockmate.io/',\n  cleanupActions = {},\n  additionalUrlParams = null,\n  pollingTimeoutMs = 1000\n}) => {\n  // For oauth\n  const startOauthSuccessPolling = () => {\n    const oauthPollingInterval = setInterval(() => {\n      const params = new URLSearchParams(window.location.search)\n      const maybeOauthConnectedAccount = params.get(OAUTH_QUERY_PARAM)\n      if (maybeOauthConnectedAccount) {\n        params.delete(OAUTH_QUERY_PARAM)\n        localStorage.setItem(\n          OAUTH_LOCAL_STORAGE_KEY,\n          maybeOauthConnectedAccount\n        )\n        // // This will redirect the user to the same page without the query param, but with state in localStorage\n        // location.replace(\n        //   `${window.location.origin}${\n        //     window.location.pathname\n        //   }?${params.toString()}`\n        // )\n        window.close();\n      }\n    }, pollingTimeoutMs)\n  }\n\n  const startDepositSuccessPolling = () => {\n    const depositSuccessPollingInterval = setInterval(() => {\n      const params = new URLSearchParams(window.location.search)\n      const maybeDepositIdParam = params.get(DEPOSIT_ID_PARAM)\n      const maybeSuccessParam = String(\n        params.get(DEPOSIT_SUCCESS_PARAM)\n      ).toLowerCase()\n      if (\n        !maybeDepositIdParam ||\n        !['true', 'false'].includes(maybeSuccessParam)\n      ) {\n        return\n      }\n      if (maybeSuccessParam === 'true') {\n        localStorage.setItem(DEPOSIT_ERROR_STORAGE_KEY, 'success')\n      } else if (maybeSuccessParam === 'false') {\n        const detailParam = params.get('detail')\n        localStorage.setItem(DEPOSIT_ERROR_STORAGE_KEY, detailParam)\n      }\n      params.delete(DEPOSIT_SUCCESS_PARAM)\n      params.delete('detail')\n      params.set(DEPOSIT_SUCCESS_PARAM_FOR_MERCHANT, maybeSuccessParam)\n      location.replace(\n        `${window.location.origin}${\n          window.location.pathname\n        }?${params.toString()}`\n      )\n    }, pollingTimeoutMs)\n  }\n\n  // For oauth\n  const startLocalStoragePolling = () => {\n    const localStoragePollingInterval = setInterval(() => {\n      const oauthConnectedAccount = localStorage.getItem(\n        OAUTH_LOCAL_STORAGE_KEY\n      )\n      const currentUrl = new URL(window.location.href)\n      const oauthQueryParamDeletedAlready =\n        !currentUrl.searchParams.has(OAUTH_QUERY_PARAM)\n      const depositError = localStorage.getItem(DEPOSIT_ERROR_STORAGE_KEY)\n      const depositErrorParamDeletedAlready = !currentUrl.searchParams.has(\n        DEPOSIT_SUCCESS_PARAM\n      )\n      const modalType = localStorage.getItem(MODAL_TYPE_LOCAL_STORAGE_KEY)\n      if (depositErrorParamDeletedAlready && typeof depositError === 'string') {\n        createIframe(\n          new URL(EVENT_MESSAGES?.[modalType] ?? '', url).href,\n          undefined,\n          undefined,\n          undefined,\n          depositError\n        )\n        localStorage.removeItem(DEPOSIT_ERROR_STORAGE_KEY)\n      } else if (oauthConnectedAccount && oauthQueryParamDeletedAlready) {\n        let path = EVENT_MESSAGES.linkConnect\n        let step\n        if (localStorage.getItem(DEPOSIT_JWT_LOCAL_STORAGE_KEY)) {\n          if (modalType === 'deposit') {\n            path = EVENT_MESSAGES.deposit\n            step = DEPOSIT_OAUTH_SUCCESS_STEP\n          } else if (modalType === 'withdrawal') {\n            path = EVENT_MESSAGES.withdrawal\n            step = DEPOSIT_OAUTH_SUCCESS_STEP\n          }\n        }\n        createIframe(\n          new URL(path, url).href,\n          undefined,\n          oauthConnectedAccount,\n          step,\n          undefined\n        )\n        // Delete from localStorage, but from the original tab, not the new tab used from oauth\n        const params = new URLSearchParams(window.location.search)\n        const maybeOauthConnectedAccount = params.get(OAUTH_QUERY_PARAM)\n        if (!maybeOauthConnectedAccount) {\n          localStorage.removeItem(OAUTH_LOCAL_STORAGE_KEY)\n        }\n      }\n    }, pollingTimeoutMs)\n  }\n\n  const body = document.querySelector('body')\n\n  const spinnerId = 'iframe-loading-spinner'\n\n  const createSpinner = () => {\n    const spinnerWrapper = document.createElement('div')\n    spinnerWrapper.setAttribute('id', spinnerId)\n    spinnerWrapper.setAttribute(\n      'style',\n      `\n        position: fixed;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%, -50%);\n        z-index: 101;\n      `\n    )\n\n    const spinner = document.createElement('div')\n    spinner.setAttribute(\n      'style',\n      `\n        width: 48px;\n        height: 48px;\n        border: 6px solid rgba(255, 255, 255, 0.3);\n        border-top-color: white;\n        border-radius: 50%;\n        animation: spin 1s linear infinite;\n      `\n    )\n\n    spinnerWrapper.appendChild(spinner)\n    body.appendChild(spinnerWrapper)\n\n    const style = document.createElement('style')\n    style.innerHTML = `\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n    `\n    document.head.appendChild(style)\n  }\n\n  const iframeStyle =\n    'display:block; position:fixed; width:100%; height:100%; z-index:100; border:none; top:0; right:0; background-color: rgba(0, 0, 0, 0.55);'\n\n  const createIframe = (\n    url,\n    accountId,\n    oauthConnectedAccount,\n    step,\n    depositError,\n    includeDefaultJwt = true\n  ) => {\n    const iframeId = 'link-iframe'\n    const existingIframe = document.getElementById(iframeId)\n    if (!existingIframe) {\n      createSpinner();\n      const iframeUrl = new URL(url)\n      const parentUrlEncoded = Buffer.from(window.location.href).toString(\n        'base64'\n      )\n      const token =\n        includeDefaultJwt &&\n        (jwt || localStorage.getItem(DEPOSIT_JWT_LOCAL_STORAGE_KEY))\n      const storedLang = localStorage.getItem(DEPOSIT_LANG_LOCAL_STORAGE_KEY)\n      const mergedAdditionalUrlParams = {\n        ...(additionalUrlParams ?? {})\n      }\n      if (iframeUrl.searchParams.has('lang')) {\n        delete mergedAdditionalUrlParams.lang\n      } else if (!Object.hasOwn(mergedAdditionalUrlParams, 'lang') && storedLang) {\n        mergedAdditionalUrlParams.lang = storedLang\n      }\n      const params = new URLSearchParams(window.location.search)\n      const providerNameParam = params.get('providerName')\n      const urlParamsArray = [\n        ['jwt', token],\n        ['accountId', accountId],\n        ['step', step],\n        ['depositError', depositError],\n        ['providerName', providerNameParam],\n        ['parentUrlEncoded', parentUrlEncoded],\n        ...Object.entries(mergedAdditionalUrlParams)\n      ].filter(([_, value]) => value)\n      let urlParams = urlParamsArray\n        .map(([key, value]) => `${key}=${value}`)\n        .join('&')\n      if (url.includes('?')) {\n        urlParams = `&${urlParams}`\n      } else if (urlParams.length > 0) {\n        urlParams = `?${urlParams}`\n      }\n      let urlWithParams = `${url}${urlParams}`\n      if (oauthConnectedAccount) {\n        urlWithParams += `&${OAUTH_QUERY_PARAM}=${oauthConnectedAccount}`\n      }\n\n      const iframe = document.createElement('iframe')\n      iframe.setAttribute('src', urlWithParams)\n      iframe.setAttribute('style', iframeStyle)\n      iframe.setAttribute('id', iframeId)\n      iframe.setAttribute('allow', 'camera') // For QR-code scanning\n\n      iframe.addEventListener('load', () => {\n        const spinner = document.getElementById(spinnerId)\n        if (spinner) spinner.remove()\n      })\n\n      body.appendChild(iframe)\n    }\n  }\n\n  const removeIframe = (event) => {\n    const iframe = document.querySelector('#link-iframe')\n    if (iframe) {\n      body.removeChild(iframe)\n    }\n    if (event.data.url) {\n      window.location = event.data.url\n    }\n\n    const endResult = event?.data?.endResult\n    if (endResult && cleanupActions[endResult]) {\n      cleanupActions[endResult]()\n    }\n  }\n\n  startDepositSuccessPolling()\n  startOauthSuccessPolling()\n  startLocalStoragePolling()\n\n  let redirectWindow = null\n\n  window.onmessage = function (event) {\n    console.log('[BlockmateLink] window.onmessage received', {\n      origin: event.origin,\n      type: event?.data?.type,\n      data: event?.data\n    })\n    if (!Object.hasOwn(EVENT_MESSAGES, event.data.type)) {\n      console.log('[BlockmateLink] window.onmessage ignored (unknown type)', {\n        type: event?.data?.type\n      })\n      return null\n    }\n\n    // These actions can only be called from within the iframe, check origin as they can perform redirects of the parent\n    if (['close', 'redirect', 'redirect-close'].includes(event?.data?.type)) {\n      if (!TRUSTED_ORIGINS.includes(event.origin)) {\n        console.log('[BlockmateLink] window.onmessage ignored (untrusted origin)', {\n          origin: event.origin,\n          type: event?.data?.type\n        })\n        return null\n      }\n    }\n\n    if (event?.data?.type === 'init') {\n      console.log('[BlockmateLink] window.onmessage init')\n      localStorage.removeItem(OAUTH_LOCAL_STORAGE_KEY);\n    } else if (event?.data?.type === 'close') {\n      console.log('[BlockmateLink] window.onmessage close', {\n        endResult: event?.data?.endResult\n      })\n      if (jwt) {\n        localStorage.setItem(DEPOSIT_JWT_LOCAL_STORAGE_KEY, jwt)\n      }\n      removeIframe(event)\n    } else if (event?.data?.type === 'redirect') {\n      console.log('[BlockmateLink] window.onmessage redirect', {\n        targetUrl: event?.data?.targetUrl,\n        inNewTab: event?.data?.inNewTab\n      })\n      if (jwt) {\n        localStorage.setItem(DEPOSIT_JWT_LOCAL_STORAGE_KEY, jwt)\n      }\n      if (event.data.inNewTab) {\n        redirectWindow = window.open(event.data.targetUrl, '_blank')\n        if (!redirectWindow) {\n          console.error('Redirect blocked by browser popup blocker', {\n            targetUrl: event.data.targetUrl,\n            inNewTab: true,\n            origin: event.origin\n          })\n        }\n      } else {\n        redirectWindow = null\n        window.location.assign(event.data.targetUrl)\n      }\n    } else if (event?.data?.type === 'redirect-close') {\n      console.log('[BlockmateLink] window.onmessage redirect-close', {\n        redirectWindow\n      })\n      if (redirectWindow && !redirectWindow.closed) {\n        console.log('[BlockmateLink] window.onmessage closing redirectWindow')\n        redirectWindow.close()\n      }\n      console.log('[BlockmateLink] window.onmessage resetting redirectWindow')\n      redirectWindow = null\n    } else {\n      console.log('[BlockmateLink] window.onmessage open iframe', {\n        type: event?.data?.type,\n        extraUrlParams: event?.data?.extraUrlParams\n      })\n      let urlParams = Object.entries(event?.data?.extraUrlParams ?? {})\n        .map(([key, value]) => `${key}=${value}`)\n        .join('&')\n      if (urlParams.length > 0) {\n        urlParams = `?${urlParams}`\n      }\n      const includeDefaultJwt = !event.data.extraUrlParams?.jwt\n      createIframe(\n        new URL(`${EVENT_MESSAGES[event.data.type]}${urlParams}`, url).href,\n        event.data?.accountId,\n        event.data?.oauthConnectedAccount,\n        undefined,\n        undefined,\n        includeDefaultJwt\n      )\n    }\n  }\n}\n\n// React component\nexport const LinkModal = ({\n  jwt,\n  url = 'https://link.blockmate.io/',\n  cleanupActions = {},\n  additionalUrlParams = null\n}) => {\n  createLinkModal({ jwt, url, cleanupActions, additionalUrlParams })\n  return null\n}\n\nif (typeof window !== 'undefined') {\n  window.BlockmateLink = {\n    handleOpen,\n    handleClose,\n    handleRedirect,\n    handleCloseRedirect,\n    createLinkModal,\n    handleInit\n  }\n}\n"],"names":["window","Buffer","require","EVENT_MESSAGES","linkConnect","verifyPhone","changePhone","enableTransfer","transferAssets","cryptoSavings","withdrawAssets","close","redirect","redirectClose","deposit","directDeposit","withdrawal","TRUSTED_ORIGINS","OAUTH_QUERY_PARAM","OAUTH_LOCAL_STORAGE_KEY","DEPOSIT_OAUTH_SUCCESS_STEP","DEPOSIT_ID_PARAM","DEPOSIT_SUCCESS_PARAM","DEPOSIT_SUCCESS_PARAM_FOR_MERCHANT","DEPOSIT_ERROR_STORAGE_KEY","DEPOSIT_JWT_LOCAL_STORAGE_KEY","DEPOSIT_LANG_LOCAL_STORAGE_KEY","MODAL_TYPE_LOCAL_STORAGE_KEY","handleOpen","message","accountId","oauthConnectedAccount","extraUrlParams","console","log","Object","keys","includes","jwt","localStorage","setItem","lang","storedLang","getItem","mergedExtraUrlParams","_extends","hasOwn","parent","postMessage","type","handleClose","endResult","handleRedirect","targetUrl","inNewTab","handleCloseRedirect","handleInit","createLinkModal","url","cleanupActions","additionalUrlParams","pollingTimeoutMs","startOauthSuccessPolling","setInterval","params","URLSearchParams","location","search","maybeOauthConnectedAccount","get","delete","startDepositSuccessPolling","maybeDepositIdParam","maybeSuccessParam","String","toLowerCase","detailParam","set","replace","origin","pathname","toString","startLocalStoragePolling","currentUrl","URL","href","oauthQueryParamDeletedAlready","searchParams","has","depositError","depositErrorParamDeletedAlready","modalType","_EVENT_MESSAGES$modal","createIframe","undefined","removeItem","path","step","body","document","querySelector","spinnerId","createSpinner","spinnerWrapper","createElement","setAttribute","spinner","appendChild","style","innerHTML","head","iframeStyle","includeDefaultJwt","iframeId","existingIframe","getElementById","iframeUrl","parentUrlEncoded","from","token","mergedAdditionalUrlParams","providerNameParam","urlParamsArray","entries","filter","_","value","urlParams","map","key","join","length","urlWithParams","iframe","addEventListener","remove","removeIframe","event","_event$data","removeChild","data","redirectWindow","onmessage","_event$data2","_event$data4","_event$data6","_event$data7","_event$data9","_event$data10","_event$data3","_event$data5","_event$data8","_event$data0","_event$data1","open","error","assign","closed","_event$data11","_event$data12","_event$data$extraUrlP","_event$data13","_event$data$extraUrlP2","_event$data14","_event$data15","LinkModal","BlockmateLink"],"mappings":";;;;;;;;;;AAAA;;AAEAA,MAAM,CAACC,MAAM,GAAGD,MAAM,CAACC,MAAM,IAAIC,OAAO,CAAC,QAAQ,CAAC,CAACD,MAAM,CAAA;AAEzD,MAAME,cAAc,GAAG;AACrBC,EAAAA,WAAW,EAAE,CAAE,CAAA;AACfC,EAAAA,WAAW,EAAE,CAAc,YAAA,CAAA;AAC3BC,EAAAA,WAAW,EAAE,CAAc,YAAA,CAAA;AAC3BC,EAAAA,cAAc,EAAE,CAAiB,eAAA,CAAA;AACjCC,EAAAA,cAAc,EAAE,CAAiB,eAAA,CAAA;AACjCC,EAAAA,aAAa,EAAE,CAAgB,cAAA,CAAA;AAC/BC,EAAAA,cAAc,EAAE,CAAiB,eAAA,CAAA;AACjCC,EAAAA,KAAK,EAAE,wBAAwB;AAC/BC,EAAAA,QAAQ,EAAE,UAAU;AACpBC,EAAAA,aAAa,EAAE,gBAAgB;AAC/BC,EAAAA,OAAO,EAAE,kBAAkB;AAC3BC,EAAAA,aAAa,EAAE,wBAAwB;AACvCC,EAAAA,UAAU,EAAE,qBAAA;AACd,CAAC,CAAA;AAED,MAAMC,eAAe,GAAG,CACtB,2BAA2B,EAC3B,mCAAmC,EACnC,8BAA8B,EAC9B,uBAAuB,CACxB,CAAA;AAED,MAAMC,iBAAiB,GAAG,uBAAuB,CAAA;AACjD,MAAMC,uBAAuB,GAAG,yBAAyB,CAAA;AACzD,MAAMC,0BAA0B,GAAG,eAAe,CAAA;AAClD,MAAMC,gBAAgB,GAAG,YAAY,CAAA;AACrC,MAAMC,qBAAqB,GAAG,SAAS,CAAA;AACvC,MAAMC,kCAAkC,GAAG,iBAAiB,CAAA;AAC5D,MAAMC,yBAAyB,GAAG,eAAe,CAAA;AACjD,MAAMC,6BAA6B,GAAG,aAAa,CAAA;AACnD,MAAMC,8BAA8B,GAAG,cAAc,CAAA;AACrD,MAAMC,4BAA4B,GAAG,YAAY,CAAA;AAEpCC,MAAAA,UAAU,GAAGA,CACxBC,OAAO,GAAG,EAAE,EACZC,SAAS,EACTC,qBAAqB,EACrBC,cAAc,KACX;AACHC,EAAAA,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAE;IAC/CL,OAAO;IACPC,SAAS;IACTC,qBAAqB;AACrBC,IAAAA,cAAAA;AACF,GAAC,CAAC,CAAA;AACF,EAAA,IAAI,CAACG,MAAM,CAACC,IAAI,CAACjC,cAAc,CAAC,CAACkC,QAAQ,CAACR,OAAO,CAAC,EAAE;AAClDA,IAAAA,OAAO,GAAG,aAAa,CAAA;AACzB,GAAA;AACA,EAAA,IAAIG,cAAc,IAAA,IAAA,IAAdA,cAAc,CAAEM,GAAG,EAAE;IACvBC,YAAY,CAACC,OAAO,CAACf,6BAA6B,EAAEO,cAAc,CAACM,GAAG,CAAC,CAAA;AACzE,GAAA;AACA,EAAA,IAAIN,cAAc,IAAA,IAAA,IAAdA,cAAc,CAAES,IAAI,EAAE;IACxBF,YAAY,CAACC,OAAO,CAACd,8BAA8B,EAAEM,cAAc,CAACS,IAAI,CAAC,CAAA;AAC3E,GAAA;AACA,EAAA,MAAMC,UAAU,GAAGH,YAAY,CAACI,OAAO,CAACjB,8BAA8B,CAAC,CAAA;EACvE,MAAMkB,oBAAoB,GAAAC,QAAA,CACpBb,EAAAA,EAAAA,cAAc,WAAdA,cAAc,GAAI,EAAE,CACzB,CAAA;EACD,IAAI,CAACG,MAAM,CAACW,MAAM,CAACF,oBAAoB,EAAE,MAAM,CAAC,IAAIF,UAAU,EAAE;IAC9DE,oBAAoB,CAACH,IAAI,GAAGC,UAAU,CAAA;AACxC,GAAA;AACAT,EAAAA,OAAO,CAACC,GAAG,CAAC,0CAA0C,EAAE;IACtDL,OAAO;AACPe,IAAAA,oBAAAA;AACF,GAAC,CAAC,CAAA;AACFL,EAAAA,YAAY,CAACC,OAAO,CAACb,4BAA4B,EAAEE,OAAO,CAAC,CAAA;AAC3D7B,EAAAA,MAAM,CAAC+C,MAAM,CAACC,WAAW,CACvB;AACEC,IAAAA,IAAI,EAAEpB,OAAO;IACbC,SAAS;IACTC,qBAAqB;AACrBC,IAAAA,cAAc,EAAEY,oBAAAA;GACjB,EACD,GACF,CAAC,CAAA;AACH,EAAC;AAEYM,MAAAA,WAAW,GAAIC,SAAS,IAAK;AACxCnD,EAAAA,MAAM,CAAC+C,MAAM,CAACC,WAAW,CAAC;AAAEC,IAAAA,IAAI,EAAE,OAAO;AAAEE,IAAAA,SAAAA;GAAW,EAAE,GAAG,CAAC,CAAA;AAC9D,EAAC;AAEM,MAAMC,cAAc,GAAGA,CAACC,SAAS,EAAEC,QAAQ,GAAG,KAAK,KAAK;AAC7DtD,EAAAA,MAAM,CAAC+C,MAAM,CAACC,WAAW,CAAC;AAAEC,IAAAA,IAAI,EAAE,UAAU;IAAEI,SAAS;AAAEC,IAAAA,QAAAA;GAAU,EAAE,GAAG,CAAC,CAAA;AAC3E,EAAC;AAEYC,MAAAA,mBAAmB,GAAGA,MAAM;AACvCtB,EAAAA,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC,CAAA;AACzDlC,EAAAA,MAAM,CAAC+C,MAAM,CAACC,WAAW,CAAC;AAAEC,IAAAA,IAAI,EAAE,eAAA;GAAiB,EAAE,GAAG,CAAC,CAAA;AAC3D,EAAC;AAEYO,MAAAA,UAAU,GAAGA,MAAM;AAC9BxD,EAAAA,MAAM,CAAC+C,MAAM,CAACC,WAAW,CAAC;AAAEC,IAAAA,IAAI,EAAE,MAAA;GAAQ,EAAE,GAAG,CAAC,CAAA;AAClD,EAAC;AAEM,MAAMQ,eAAe,GAAGA,CAAC;EAC9BnB,GAAG;EACHoB,GAAG,EAAHA,IAAG,GAAG,4BAA4B;AAClCC,EAAAA,cAAc,EAAdA,eAAc,GAAG,EAAE;EACnBC,mBAAmB,EAAnBA,oBAAmB,GAAG,IAAI;EAC1BC,gBAAgB,EAAhBA,iBAAgB,GAAG,IAAA;AACrB,CAAC,KAAK;AACJ;EACA,MAAMC,wBAAwB,GAAGA,MAAM;AACrC,IAA6BC,WAAW,CAAC,MAAM;MAC7C,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACjE,MAAM,CAACkE,QAAQ,CAACC,MAAM,CAAC,CAAA;AAC1D,MAAA,MAAMC,0BAA0B,GAAGJ,MAAM,CAACK,GAAG,CAACnD,iBAAiB,CAAC,CAAA;AAChE,MAAA,IAAIkD,0BAA0B,EAAE;AAC9BJ,QAAAA,MAAM,CAACM,MAAM,CAACpD,iBAAiB,CAAC,CAAA;AAChCqB,QAAAA,YAAY,CAACC,OAAO,CAClBrB,uBAAuB,EACvBiD,0BACF,CAAC,CAAA;AACD;AACA;AACA;AACA;AACA;AACA;QACApE,MAAM,CAACW,KAAK,EAAE,CAAA;AAChB,OAAA;KACD,EAAEkD,iBAAgB,EAAC;GACrB,CAAA;EAED,MAAMU,0BAA0B,GAAGA,MAAM;AACvC,IAAsCR,WAAW,CAAC,MAAM;MACtD,MAAMC,MAAM,GAAG,IAAIC,eAAe,CAACjE,MAAM,CAACkE,QAAQ,CAACC,MAAM,CAAC,CAAA;AAC1D,MAAA,MAAMK,mBAAmB,GAAGR,MAAM,CAACK,GAAG,CAAChD,gBAAgB,CAAC,CAAA;AACxD,MAAA,MAAMoD,iBAAiB,GAAGC,MAAM,CAC9BV,MAAM,CAACK,GAAG,CAAC/C,qBAAqB,CAClC,CAAC,CAACqD,WAAW,EAAE,CAAA;AACf,MAAA,IACE,CAACH,mBAAmB,IACpB,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,CAACnC,QAAQ,CAACoC,iBAAiB,CAAC,EAC9C;AACA,QAAA,OAAA;AACF,OAAA;MACA,IAAIA,iBAAiB,KAAK,MAAM,EAAE;AAChClC,QAAAA,YAAY,CAACC,OAAO,CAAChB,yBAAyB,EAAE,SAAS,CAAC,CAAA;AAC5D,OAAC,MAAM,IAAIiD,iBAAiB,KAAK,OAAO,EAAE;AACxC,QAAA,MAAMG,WAAW,GAAGZ,MAAM,CAACK,GAAG,CAAC,QAAQ,CAAC,CAAA;AACxC9B,QAAAA,YAAY,CAACC,OAAO,CAAChB,yBAAyB,EAAEoD,WAAW,CAAC,CAAA;AAC9D,OAAA;AACAZ,MAAAA,MAAM,CAACM,MAAM,CAAChD,qBAAqB,CAAC,CAAA;AACpC0C,MAAAA,MAAM,CAACM,MAAM,CAAC,QAAQ,CAAC,CAAA;AACvBN,MAAAA,MAAM,CAACa,GAAG,CAACtD,kCAAkC,EAAEkD,iBAAiB,CAAC,CAAA;MACjEP,QAAQ,CAACY,OAAO,CACd,CAAA,EAAG9E,MAAM,CAACkE,QAAQ,CAACa,MAAM,CACvB/E,EAAAA,MAAM,CAACkE,QAAQ,CAACc,QAAQ,CACtBhB,CAAAA,EAAAA,MAAM,CAACiB,QAAQ,EAAE,CAAA,CACvB,CAAC,CAAA;KACF,EAAEpB,iBAAgB,EAAC;GACrB,CAAA;;AAED;EACA,MAAMqB,wBAAwB,GAAGA,MAAM;AACrC,IAAoCnB,WAAW,CAAC,MAAM;AACpD,MAAA,MAAMhC,qBAAqB,GAAGQ,YAAY,CAACI,OAAO,CAChDxB,uBACF,CAAC,CAAA;MACD,MAAMgE,UAAU,GAAG,IAAIC,GAAG,CAACpF,MAAM,CAACkE,QAAQ,CAACmB,IAAI,CAAC,CAAA;MAChD,MAAMC,6BAA6B,GACjC,CAACH,UAAU,CAACI,YAAY,CAACC,GAAG,CAACtE,iBAAiB,CAAC,CAAA;AACjD,MAAA,MAAMuE,YAAY,GAAGlD,YAAY,CAACI,OAAO,CAACnB,yBAAyB,CAAC,CAAA;MACpE,MAAMkE,+BAA+B,GAAG,CAACP,UAAU,CAACI,YAAY,CAACC,GAAG,CAClElE,qBACF,CAAC,CAAA;AACD,MAAA,MAAMqE,SAAS,GAAGpD,YAAY,CAACI,OAAO,CAAChB,4BAA4B,CAAC,CAAA;AACpE,MAAA,IAAI+D,+BAA+B,IAAI,OAAOD,YAAY,KAAK,QAAQ,EAAE;AAAA,QAAA,IAAAG,qBAAA,CAAA;AACvEC,QAAAA,YAAY,CACV,IAAIT,GAAG,CAAA,CAAAQ,qBAAA,GAACzF,cAAc,IAAA,IAAA,GAAA,KAAA,CAAA,GAAdA,cAAc,CAAGwF,SAAS,CAAC,KAAAC,IAAAA,GAAAA,qBAAA,GAAI,EAAE,EAAElC,IAAG,CAAC,CAAC2B,IAAI,EACpDS,SAAS,EACTA,SAAS,EACTA,SAAS,EACTL,YACF,CAAC,CAAA;AACDlD,QAAAA,YAAY,CAACwD,UAAU,CAACvE,yBAAyB,CAAC,CAAA;AACpD,OAAC,MAAM,IAAIO,qBAAqB,IAAIuD,6BAA6B,EAAE;AACjE,QAAA,IAAIU,IAAI,GAAG7F,cAAc,CAACC,WAAW,CAAA;AACrC,QAAA,IAAI6F,IAAI,CAAA;AACR,QAAA,IAAI1D,YAAY,CAACI,OAAO,CAAClB,6BAA6B,CAAC,EAAE;UACvD,IAAIkE,SAAS,KAAK,SAAS,EAAE;YAC3BK,IAAI,GAAG7F,cAAc,CAACW,OAAO,CAAA;AAC7BmF,YAAAA,IAAI,GAAG7E,0BAA0B,CAAA;AACnC,WAAC,MAAM,IAAIuE,SAAS,KAAK,YAAY,EAAE;YACrCK,IAAI,GAAG7F,cAAc,CAACa,UAAU,CAAA;AAChCiF,YAAAA,IAAI,GAAG7E,0BAA0B,CAAA;AACnC,WAAA;AACF,SAAA;AACAyE,QAAAA,YAAY,CACV,IAAIT,GAAG,CAACY,IAAI,EAAEtC,IAAG,CAAC,CAAC2B,IAAI,EACvBS,SAAS,EACT/D,qBAAqB,EACrBkE,IAAI,EACJH,SACF,CAAC,CAAA;AACD;QACA,MAAM9B,MAAM,GAAG,IAAIC,eAAe,CAACjE,MAAM,CAACkE,QAAQ,CAACC,MAAM,CAAC,CAAA;AAC1D,QAAA,MAAMC,0BAA0B,GAAGJ,MAAM,CAACK,GAAG,CAACnD,iBAAiB,CAAC,CAAA;QAChE,IAAI,CAACkD,0BAA0B,EAAE;AAC/B7B,UAAAA,YAAY,CAACwD,UAAU,CAAC5E,uBAAuB,CAAC,CAAA;AAClD,SAAA;AACF,OAAA;KACD,EAAE0C,iBAAgB,EAAC;GACrB,CAAA;AAED,EAAA,MAAMqC,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC,CAAA;EAE3C,MAAMC,SAAS,GAAG,wBAAwB,CAAA;EAE1C,MAAMC,aAAa,GAAGA,MAAM;AAC1B,IAAA,MAAMC,cAAc,GAAGJ,QAAQ,CAACK,aAAa,CAAC,KAAK,CAAC,CAAA;AACpDD,IAAAA,cAAc,CAACE,YAAY,CAAC,IAAI,EAAEJ,SAAS,CAAC,CAAA;AAC5CE,IAAAA,cAAc,CAACE,YAAY,CACzB,OAAO,EACP,CAAA;AACN;AACA;AACA;AACA;AACA;AACA,MAAA,CACI,CAAC,CAAA;AAED,IAAA,MAAMC,OAAO,GAAGP,QAAQ,CAACK,aAAa,CAAC,KAAK,CAAC,CAAA;AAC7CE,IAAAA,OAAO,CAACD,YAAY,CAClB,OAAO,EACP,CAAA;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAA,CACI,CAAC,CAAA;AAEDF,IAAAA,cAAc,CAACI,WAAW,CAACD,OAAO,CAAC,CAAA;AACnCR,IAAAA,IAAI,CAACS,WAAW,CAACJ,cAAc,CAAC,CAAA;AAEhC,IAAA,MAAMK,KAAK,GAAGT,QAAQ,CAACK,aAAa,CAAC,OAAO,CAAC,CAAA;IAC7CI,KAAK,CAACC,SAAS,GAAG,CAAA;AACtB;AACA;AACA;AACA;AACA,IAAK,CAAA,CAAA;AACDV,IAAAA,QAAQ,CAACW,IAAI,CAACH,WAAW,CAACC,KAAK,CAAC,CAAA;GACjC,CAAA;EAED,MAAMG,WAAW,GACf,0IAA0I,CAAA;AAE5I,EAAA,MAAMlB,YAAY,GAAGA,CACnBnC,GAAG,EACH5B,SAAS,EACTC,qBAAqB,EACrBkE,IAAI,EACJR,YAAY,EACZuB,iBAAiB,GAAG,IAAI,KACrB;IACH,MAAMC,QAAQ,GAAG,aAAa,CAAA;AAC9B,IAAA,MAAMC,cAAc,GAAGf,QAAQ,CAACgB,cAAc,CAACF,QAAQ,CAAC,CAAA;IACxD,IAAI,CAACC,cAAc,EAAE;AACnBZ,MAAAA,aAAa,EAAE,CAAA;AACf,MAAA,MAAMc,SAAS,GAAG,IAAIhC,GAAG,CAAC1B,GAAG,CAAC,CAAA;AAC9B,MAAA,MAAM2D,gBAAgB,GAAGpH,MAAM,CAACqH,IAAI,CAACtH,MAAM,CAACkE,QAAQ,CAACmB,IAAI,CAAC,CAACJ,QAAQ,CACjE,QACF,CAAC,CAAA;AACD,MAAA,MAAMsC,KAAK,GACTP,iBAAiB,KAChB1E,GAAG,IAAIC,YAAY,CAACI,OAAO,CAAClB,6BAA6B,CAAC,CAAC,CAAA;AAC9D,MAAA,MAAMiB,UAAU,GAAGH,YAAY,CAACI,OAAO,CAACjB,8BAA8B,CAAC,CAAA;MACvE,MAAM8F,yBAAyB,GAAA3E,QAAA,CACzBe,EAAAA,EAAAA,oBAAmB,WAAnBA,oBAAmB,GAAI,EAAE,CAC9B,CAAA;MACD,IAAIwD,SAAS,CAAC7B,YAAY,CAACC,GAAG,CAAC,MAAM,CAAC,EAAE;QACtC,OAAOgC,yBAAyB,CAAC/E,IAAI,CAAA;AACvC,OAAC,MAAM,IAAI,CAACN,MAAM,CAACW,MAAM,CAAC0E,yBAAyB,EAAE,MAAM,CAAC,IAAI9E,UAAU,EAAE;QAC1E8E,yBAAyB,CAAC/E,IAAI,GAAGC,UAAU,CAAA;AAC7C,OAAA;MACA,MAAMsB,MAAM,GAAG,IAAIC,eAAe,CAACjE,MAAM,CAACkE,QAAQ,CAACC,MAAM,CAAC,CAAA;AAC1D,MAAA,MAAMsD,iBAAiB,GAAGzD,MAAM,CAACK,GAAG,CAAC,cAAc,CAAC,CAAA;MACpD,MAAMqD,cAAc,GAAG,CACrB,CAAC,KAAK,EAAEH,KAAK,CAAC,EACd,CAAC,WAAW,EAAEzF,SAAS,CAAC,EACxB,CAAC,MAAM,EAAEmE,IAAI,CAAC,EACd,CAAC,cAAc,EAAER,YAAY,CAAC,EAC9B,CAAC,cAAc,EAAEgC,iBAAiB,CAAC,EACnC,CAAC,kBAAkB,EAAEJ,gBAAgB,CAAC,EACtC,GAAGlF,MAAM,CAACwF,OAAO,CAACH,yBAAyB,CAAC,CAC7C,CAACI,MAAM,CAAC,CAAC,CAACC,CAAC,EAAEC,KAAK,CAAC,KAAKA,KAAK,CAAC,CAAA;MAC/B,IAAIC,SAAS,GAAGL,cAAc,CAC3BM,GAAG,CAAC,CAAC,CAACC,GAAG,EAAEH,KAAK,CAAC,KAAK,CAAA,EAAGG,GAAG,CAAA,CAAA,EAAIH,KAAK,CAAA,CAAE,CAAC,CACxCI,IAAI,CAAC,GAAG,CAAC,CAAA;AACZ,MAAA,IAAIxE,GAAG,CAACrB,QAAQ,CAAC,GAAG,CAAC,EAAE;QACrB0F,SAAS,GAAG,CAAIA,CAAAA,EAAAA,SAAS,CAAE,CAAA,CAAA;AAC7B,OAAC,MAAM,IAAIA,SAAS,CAACI,MAAM,GAAG,CAAC,EAAE;QAC/BJ,SAAS,GAAG,CAAIA,CAAAA,EAAAA,SAAS,CAAE,CAAA,CAAA;AAC7B,OAAA;AACA,MAAA,IAAIK,aAAa,GAAG,CAAA,EAAG1E,GAAG,CAAA,EAAGqE,SAAS,CAAE,CAAA,CAAA;AACxC,MAAA,IAAIhG,qBAAqB,EAAE;AACzBqG,QAAAA,aAAa,IAAI,CAAA,CAAA,EAAIlH,iBAAiB,CAAA,CAAA,EAAIa,qBAAqB,CAAE,CAAA,CAAA;AACnE,OAAA;AAEA,MAAA,MAAMsG,MAAM,GAAGlC,QAAQ,CAACK,aAAa,CAAC,QAAQ,CAAC,CAAA;AAC/C6B,MAAAA,MAAM,CAAC5B,YAAY,CAAC,KAAK,EAAE2B,aAAa,CAAC,CAAA;AACzCC,MAAAA,MAAM,CAAC5B,YAAY,CAAC,OAAO,EAAEM,WAAW,CAAC,CAAA;AACzCsB,MAAAA,MAAM,CAAC5B,YAAY,CAAC,IAAI,EAAEQ,QAAQ,CAAC,CAAA;AACnCoB,MAAAA,MAAM,CAAC5B,YAAY,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;;AAEvC4B,MAAAA,MAAM,CAACC,gBAAgB,CAAC,MAAM,EAAE,MAAM;AACpC,QAAA,MAAM5B,OAAO,GAAGP,QAAQ,CAACgB,cAAc,CAACd,SAAS,CAAC,CAAA;AAClD,QAAA,IAAIK,OAAO,EAAEA,OAAO,CAAC6B,MAAM,EAAE,CAAA;AAC/B,OAAC,CAAC,CAAA;AAEFrC,MAAAA,IAAI,CAACS,WAAW,CAAC0B,MAAM,CAAC,CAAA;AAC1B,KAAA;GACD,CAAA;EAED,MAAMG,YAAY,GAAIC,KAAK,IAAK;AAAA,IAAA,IAAAC,WAAA,CAAA;AAC9B,IAAA,MAAML,MAAM,GAAGlC,QAAQ,CAACC,aAAa,CAAC,cAAc,CAAC,CAAA;AACrD,IAAA,IAAIiC,MAAM,EAAE;AACVnC,MAAAA,IAAI,CAACyC,WAAW,CAACN,MAAM,CAAC,CAAA;AAC1B,KAAA;AACA,IAAA,IAAII,KAAK,CAACG,IAAI,CAAClF,GAAG,EAAE;AAClB1D,MAAAA,MAAM,CAACkE,QAAQ,GAAGuE,KAAK,CAACG,IAAI,CAAClF,GAAG,CAAA;AAClC,KAAA;AAEA,IAAA,MAAMP,SAAS,GAAGsF,KAAK,IAAA,IAAA,IAAA,CAAAC,WAAA,GAALD,KAAK,CAAEG,IAAI,KAAA,IAAA,GAAA,KAAA,CAAA,GAAXF,WAAA,CAAavF,SAAS,CAAA;AACxC,IAAA,IAAIA,SAAS,IAAIQ,eAAc,CAACR,SAAS,CAAC,EAAE;AAC1CQ,MAAAA,eAAc,CAACR,SAAS,CAAC,EAAE,CAAA;AAC7B,KAAA;GACD,CAAA;AAEDoB,EAAAA,0BAA0B,EAAE,CAAA;AAC5BT,EAAAA,wBAAwB,EAAE,CAAA;AAC1BoB,EAAAA,wBAAwB,EAAE,CAAA;EAE1B,IAAI2D,cAAc,GAAG,IAAI,CAAA;AAEzB7I,EAAAA,MAAM,CAAC8I,SAAS,GAAG,UAAUL,KAAK,EAAE;IAAA,IAAAM,YAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,aAAA,CAAA;AAClCnH,IAAAA,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAE;MACvD6C,MAAM,EAAE0D,KAAK,CAAC1D,MAAM;MACpB9B,IAAI,EAAEwF,KAAK,IAAA,IAAA,IAAA,CAAAM,YAAA,GAALN,KAAK,CAAEG,IAAI,KAAA,IAAA,GAAA,KAAA,CAAA,GAAXG,YAAA,CAAa9F,IAAI;AACvB2F,MAAAA,IAAI,EAAEH,KAAK,IAALA,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,KAAK,CAAEG,IAAAA;AACf,KAAC,CAAC,CAAA;AACF,IAAA,IAAI,CAACzG,MAAM,CAACW,MAAM,CAAC3C,cAAc,EAAEsI,KAAK,CAACG,IAAI,CAAC3F,IAAI,CAAC,EAAE;AAAA,MAAA,IAAAoG,YAAA,CAAA;AACnDpH,MAAAA,OAAO,CAACC,GAAG,CAAC,yDAAyD,EAAE;QACrEe,IAAI,EAAEwF,KAAK,IAAA,IAAA,IAAA,CAAAY,YAAA,GAALZ,KAAK,CAAEG,IAAI,KAAXS,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,YAAA,CAAapG,IAAAA;AACrB,OAAC,CAAC,CAAA;AACF,MAAA,OAAO,IAAI,CAAA;AACb,KAAA;;AAEA;IACA,IAAI,CAAC,OAAO,EAAE,UAAU,EAAE,gBAAgB,CAAC,CAACZ,QAAQ,CAACoG,KAAK,aAAAO,YAAA,GAALP,KAAK,CAAEG,IAAI,qBAAXI,YAAA,CAAa/F,IAAI,CAAC,EAAE;MACvE,IAAI,CAAChC,eAAe,CAACoB,QAAQ,CAACoG,KAAK,CAAC1D,MAAM,CAAC,EAAE;AAAA,QAAA,IAAAuE,YAAA,CAAA;AAC3CrH,QAAAA,OAAO,CAACC,GAAG,CAAC,6DAA6D,EAAE;UACzE6C,MAAM,EAAE0D,KAAK,CAAC1D,MAAM;UACpB9B,IAAI,EAAEwF,KAAK,IAAA,IAAA,IAAA,CAAAa,YAAA,GAALb,KAAK,CAAEG,IAAI,KAAXU,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,YAAA,CAAarG,IAAAA;AACrB,SAAC,CAAC,CAAA;AACF,QAAA,OAAO,IAAI,CAAA;AACb,OAAA;AACF,KAAA;AAEA,IAAA,IAAI,CAAAwF,KAAK,IAAAQ,IAAAA,IAAAA,CAAAA,YAAA,GAALR,KAAK,CAAEG,IAAI,KAAA,IAAA,GAAA,KAAA,CAAA,GAAXK,YAAA,CAAahG,IAAI,MAAK,MAAM,EAAE;AAChChB,MAAAA,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC,CAAA;AACpDK,MAAAA,YAAY,CAACwD,UAAU,CAAC5E,uBAAuB,CAAC,CAAA;AAClD,KAAC,MAAM,IAAI,CAAAsH,KAAK,IAAA,IAAA,IAAA,CAAAS,YAAA,GAALT,KAAK,CAAEG,IAAI,qBAAXM,YAAA,CAAajG,IAAI,MAAK,OAAO,EAAE;AAAA,MAAA,IAAAsG,YAAA,CAAA;AACxCtH,MAAAA,OAAO,CAACC,GAAG,CAAC,wCAAwC,EAAE;QACpDiB,SAAS,EAAEsF,KAAK,IAAA,IAAA,IAAA,CAAAc,YAAA,GAALd,KAAK,CAAEG,IAAI,KAAXW,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,YAAA,CAAapG,SAAAA;AAC1B,OAAC,CAAC,CAAA;AACF,MAAA,IAAIb,GAAG,EAAE;AACPC,QAAAA,YAAY,CAACC,OAAO,CAACf,6BAA6B,EAAEa,GAAG,CAAC,CAAA;AAC1D,OAAA;MACAkG,YAAY,CAACC,KAAK,CAAC,CAAA;AACrB,KAAC,MAAM,IAAI,CAAAA,KAAK,IAAA,IAAA,IAAA,CAAAU,YAAA,GAALV,KAAK,CAAEG,IAAI,qBAAXO,YAAA,CAAalG,IAAI,MAAK,UAAU,EAAE;MAAA,IAAAuG,YAAA,EAAAC,YAAA,CAAA;AAC3CxH,MAAAA,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAE;QACvDmB,SAAS,EAAEoF,KAAK,IAAA,IAAA,IAAA,CAAAe,YAAA,GAALf,KAAK,CAAEG,IAAI,KAAA,IAAA,GAAA,KAAA,CAAA,GAAXY,YAAA,CAAanG,SAAS;QACjCC,QAAQ,EAAEmF,KAAK,IAAA,IAAA,IAAA,CAAAgB,YAAA,GAALhB,KAAK,CAAEG,IAAI,KAAXa,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,YAAA,CAAanG,QAAAA;AACzB,OAAC,CAAC,CAAA;AACF,MAAA,IAAIhB,GAAG,EAAE;AACPC,QAAAA,YAAY,CAACC,OAAO,CAACf,6BAA6B,EAAEa,GAAG,CAAC,CAAA;AAC1D,OAAA;AACA,MAAA,IAAImG,KAAK,CAACG,IAAI,CAACtF,QAAQ,EAAE;AACvBuF,QAAAA,cAAc,GAAG7I,MAAM,CAAC0J,IAAI,CAACjB,KAAK,CAACG,IAAI,CAACvF,SAAS,EAAE,QAAQ,CAAC,CAAA;QAC5D,IAAI,CAACwF,cAAc,EAAE;AACnB5G,UAAAA,OAAO,CAAC0H,KAAK,CAAC,2CAA2C,EAAE;AACzDtG,YAAAA,SAAS,EAAEoF,KAAK,CAACG,IAAI,CAACvF,SAAS;AAC/BC,YAAAA,QAAQ,EAAE,IAAI;YACdyB,MAAM,EAAE0D,KAAK,CAAC1D,MAAAA;AAChB,WAAC,CAAC,CAAA;AACJ,SAAA;AACF,OAAC,MAAM;AACL8D,QAAAA,cAAc,GAAG,IAAI,CAAA;QACrB7I,MAAM,CAACkE,QAAQ,CAAC0F,MAAM,CAACnB,KAAK,CAACG,IAAI,CAACvF,SAAS,CAAC,CAAA;AAC9C,OAAA;AACF,KAAC,MAAM,IAAI,CAAAoF,KAAK,IAAA,IAAA,IAAA,CAAAW,aAAA,GAALX,KAAK,CAAEG,IAAI,qBAAXQ,aAAA,CAAanG,IAAI,MAAK,gBAAgB,EAAE;AACjDhB,MAAAA,OAAO,CAACC,GAAG,CAAC,iDAAiD,EAAE;AAC7D2G,QAAAA,cAAAA;AACF,OAAC,CAAC,CAAA;AACF,MAAA,IAAIA,cAAc,IAAI,CAACA,cAAc,CAACgB,MAAM,EAAE;AAC5C5H,QAAAA,OAAO,CAACC,GAAG,CAAC,yDAAyD,CAAC,CAAA;QACtE2G,cAAc,CAAClI,KAAK,EAAE,CAAA;AACxB,OAAA;AACAsB,MAAAA,OAAO,CAACC,GAAG,CAAC,2DAA2D,CAAC,CAAA;AACxE2G,MAAAA,cAAc,GAAG,IAAI,CAAA;AACvB,KAAC,MAAM;AAAA,MAAA,IAAAiB,aAAA,EAAAC,aAAA,EAAAC,qBAAA,EAAAC,aAAA,EAAAC,sBAAA,EAAAC,aAAA,EAAAC,aAAA,CAAA;AACLnI,MAAAA,OAAO,CAACC,GAAG,CAAC,8CAA8C,EAAE;QAC1De,IAAI,EAAEwF,KAAK,IAAA,IAAA,IAAA,CAAAqB,aAAA,GAALrB,KAAK,CAAEG,IAAI,KAAA,IAAA,GAAA,KAAA,CAAA,GAAXkB,aAAA,CAAa7G,IAAI;QACvBjB,cAAc,EAAEyG,KAAK,IAAA,IAAA,IAAA,CAAAsB,aAAA,GAALtB,KAAK,CAAEG,IAAI,KAAXmB,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,aAAA,CAAa/H,cAAAA;AAC/B,OAAC,CAAC,CAAA;MACF,IAAI+F,SAAS,GAAG5F,MAAM,CAACwF,OAAO,CAAAqC,CAAAA,qBAAA,GAACvB,KAAK,IAAA,IAAA,IAAA,CAAAwB,aAAA,GAALxB,KAAK,CAAEG,IAAI,KAAA,IAAA,GAAA,KAAA,CAAA,GAAXqB,aAAA,CAAajI,cAAc,YAAAgI,qBAAA,GAAI,EAAE,CAAC,CAC9DhC,GAAG,CAAC,CAAC,CAACC,GAAG,EAAEH,KAAK,CAAC,KAAK,CAAGG,EAAAA,GAAG,IAAIH,KAAK,CAAA,CAAE,CAAC,CACxCI,IAAI,CAAC,GAAG,CAAC,CAAA;AACZ,MAAA,IAAIH,SAAS,CAACI,MAAM,GAAG,CAAC,EAAE;QACxBJ,SAAS,GAAG,CAAIA,CAAAA,EAAAA,SAAS,CAAE,CAAA,CAAA;AAC7B,OAAA;AACA,MAAA,MAAMf,iBAAiB,GAAG,EAAAkD,CAAAA,sBAAA,GAACzB,KAAK,CAACG,IAAI,CAAC5G,cAAc,KAAzBkI,IAAAA,IAAAA,sBAAA,CAA2B5H,GAAG,CAAA,CAAA;MACzDuD,YAAY,CACV,IAAIT,GAAG,CAAC,GAAGjF,cAAc,CAACsI,KAAK,CAACG,IAAI,CAAC3F,IAAI,CAAC,GAAG8E,SAAS,CAAA,CAAE,EAAErE,IAAG,CAAC,CAAC2B,IAAI,EAAA8E,CAAAA,aAAA,GACnE1B,KAAK,CAACG,IAAI,KAAVuB,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,aAAA,CAAYrI,SAAS,EAAA,CAAAsI,aAAA,GACrB3B,KAAK,CAACG,IAAI,KAAVwB,IAAAA,GAAAA,KAAAA,CAAAA,GAAAA,aAAA,CAAYrI,qBAAqB,EACjC+D,SAAS,EACTA,SAAS,EACTkB,iBACF,CAAC,CAAA;AACH,KAAA;GACD,CAAA;AACH,EAAC;;AAED;AACO,MAAMqD,SAAS,GAAGA,CAAC;EACxB/H,GAAG;EACHoB,GAAG,EAAHA,KAAG,GAAG,4BAA4B;AAClCC,EAAAA,cAAc,EAAdA,gBAAc,GAAG,EAAE;EACnBC,mBAAmB,EAAnBA,qBAAmB,GAAG,IAAA;AACxB,CAAC,KAAK;AACJH,EAAAA,eAAe,CAAC;IAAEnB,GAAG;AAAEoB,IAAAA,GAAG,EAAHA,KAAG;AAAEC,IAAAA,cAAc,EAAdA,gBAAc;AAAEC,IAAAA,mBAAmB,EAAnBA,qBAAAA;AAAoB,GAAC,CAAC,CAAA;AAClE,EAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED,IAAI,OAAO5D,MAAM,KAAK,WAAW,EAAE;EACjCA,MAAM,CAACsK,aAAa,GAAG;IACrB1I,UAAU;IACVsB,WAAW;IACXE,cAAc;IACdG,mBAAmB;IACnBE,eAAe;AACfD,IAAAA,UAAAA;GACD,CAAA;AACH;;;;"}